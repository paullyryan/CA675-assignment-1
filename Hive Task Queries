
-- TOTAL POSTS
-- TEST TO ENSURE THAT I'VE LOADED ALL 200K POSTS

SELECT COUNT(*)

FROM top200_posts
;

-- RETURN TOP 10 POSTS BY SCORE

SELECT score, id 

FROM top200_posts

ORDER BY score 

DESC LIMIT 10
;

-- RETURN TOP 10 USERS BY SCORE

SELECT userId, SUM(score) AS totalScore 

FROM top200_posts

WHERE userId IS NOT NULL

GROUP BY userId

ORDER BY totalScore DESC LIMIT 10
;

-- DISTINCT USERS WHO USED THE WORD 'Hadoop'
-- NOTE: HIVE IS CASE SENSITIVE AND WILL RETURN DIFFERENT RESULTS FOR 'Hadoop' & 'hadoop'
-- RETURNING RESULTS FOR 'Hadoop' AS PER ASSIGNMENT ASK

SELECT COUNT(DISTINCT userId)

FROM top200_posts

WHERE BODY LIKE '%Hadoop%'
;
