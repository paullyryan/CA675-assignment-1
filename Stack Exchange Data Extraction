/* PART 1 */
/* EXTRACT THE TOP 50K POSTS FROM STACK EXCHANGE. FILE SIZE LIMIT OF 50K POSTS PER DOWNLOAD */
/* ORDERING QUERY BY ID AND VIEW COUNT TO CREATE A SEQUENCE AND REMOVE POTENTIAL OF DUPLICATION AT A LATER STAGE */

SELECT TOP 50000 *

FROM posts

where posts.ViewCount > 20000

ORDER BY posts.ViewCount DESC, posts.id ASC
;

/* PART 2 */
/* AS PER PART 1, EXTRACT THE TOP 50K POSTS FROM STACK EXCHANGE */
/* ADDED SUBQUERY WHICH EXCLUDES THE TOP 50K POSTS PREVIOUSLY IDENTIFIED */
/* INCLUSION OF SUBQUERY ALLOWS USER TO PULL TOP 50,001-100,000 POSTS */

SELECT TOP 50000 *

FROM posts

where posts.ViewCount > 20000

and posts.id NOT IN

(
  SELECT TOP 50000 posts.id

  FROM posts

  ORDER BY posts.ViewCount DESC, posts.id ASC
)

ORDER BY posts.ViewCount DESC, posts.id ASC
;

/* PART 3 */
/* AS PER PART 2, EXTRACT THE TOP 50K POSTS FROM STACK EXCHANGE */
/* ADDED SUBQUERY WHICH EXCLUDES THE TOP 100K POSTS PREVIOUSLY IDENTIFIED */
/* INCLUSION OF SUBQUERY ALLOWS USER TO PULL TOP 100,001-150,000 POSTS */

SELECT TOP 50000 *

FROM posts

where posts.ViewCount > 20000

and posts.id NOT IN

(
  SELECT TOP 100000 posts.id

  FROM posts

  ORDER BY posts.ViewCount DESC
)

ORDER BY posts.ViewCount DESC
;

/* PART 4 */
/* AS PER PART 3, EXTRACT THE TOP 50K POSTS FROM STACK EXCHANGE */
/* ADDED SUBQUERY WHICH EXCLUDES THE TOP 150K POSTS PREVIOUSLY IDENTIFIED */
/* INCLUSION OF SUBQUERY ALLOWS USER TO PULL TOP 150,001-200,000 POSTS */

SELECT TOP 50000 *

FROM posts

where posts.ViewCount > 20000

and posts.id NOT IN

(
  SELECT TOP 150000 posts.id

  FROM posts

  ORDER BY posts.ViewCount DESC
)

ORDER BY posts.ViewCount DESC
